<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lista de Tareas</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <h1>Lista de Tareas</h1>

  <div id="taskForm">
    <input type="text" id="taskInput" placeholder="Escribe una tarea...">
    <button id="addTaskBtn">Agregar</button>
  </div>

  <ul id="taskList"></ul>

  <script>
    const taskInput = document.getElementById('taskInput');
    const addTaskBtn = document.getElementById('addTaskBtn');
    const taskList = document.getElementById('taskList');

    let tareas = [];

    window.addEventListener('load', () => {
      const tareasGuardadas = localStorage.getItem('tareas');
      if (tareasGuardadas) {
        tareas = JSON.parse(tareasGuardadas);
        tareas.forEach(t => agregarTareaDOM(t));
      }
    });

    function guardarEnLocalStorage() {
      localStorage.setItem('tareas', JSON.stringify(tareas));
    }

    function agregarTarea() {
      const texto = taskInput.value.trim();
      if (texto === '') return;

      const nuevaTarea = {
        id: Date.now(),
        texto: texto,
        terminada: false
      };

      tareas.push(nuevaTarea);
      agregarTareaDOM(nuevaTarea);
      guardarEnLocalStorage();

      taskInput.value = '';
    }

    function agregarTareaDOM(tarea) {
      const li = document.createElement('li');
      li.setAttribute('data-id', tarea.id);

      if (tarea.terminada) li.classList.add('completed');

      li.innerHTML = `
        <label>
          <input type="checkbox" ${tarea.terminada ? 'checked' : ''}>
          <span>${tarea.texto}</span>
        </label>
        <button class="delete">Eliminar</button>
      `;

      const checkbox = li.querySelector('input[type="checkbox"]');
      checkbox.addEventListener('change', (e) => {
        const id = parseInt(e.target.parentElement.parentElement.getAttribute('data-id'));
        const tarea = tareas.find(t => t.id === id);
        tarea.terminada = e.target.checked;
        if (tarea.terminada) li.classList.add('completed');
        else li.classList.remove('completed');
        guardarEnLocalStorage();
      });

      const deleteBtn = li.querySelector('.delete');
      deleteBtn.addEventListener('click', () => {
        const id = parseInt(li.getAttribute('data-id'));
        tareas = tareas.filter(t => t.id !== id);
        li.remove();
        guardarEnLocalStorage();
      });

      taskList.appendChild(li);
    }

    addTaskBtn.addEventListener('click', agregarTarea);
    taskInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') agregarTarea();
    });
  </script>

</body>
</html>
